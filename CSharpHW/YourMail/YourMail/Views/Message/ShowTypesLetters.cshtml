@model IEnumerable<YourMail.Interfaces.ITypesOfLetter>
@using YourMail.Infrastructure;

<hgroup class="title">
    <h2>@ViewBag.Title</h2>
</hgroup>


<section id="wrapper">
    @Html.MyGrid(Model, ViewBag.NP as string);
</section>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval");

    <script type="text/javascript">

        $(function () {
            $(".Open").click(function (event) {
                makeRequest($(this).attr("name"));
            });

            function makeRequest(id) {
                var a ="/Message/OpenLetter?letterId=" + id + "&numberOfType=@ViewBag.NumberOfType";
                location.href = "/Message/OpenLetter?letterId=" + id + "&numberOfType=@ViewBag.NumberOfType";
            };

            stileForDontRead();
            function stileForDontRead() {
                $(".IsRead").each(function () {
                    if ($(this).attr("name") === "False") {
                        $(this).closest("tr").css({ "border-color": "#008a77", "border-style": "solid" });
                    }
                });
            }

            var arrayIdOfLetters = new Array();
            $("#SendIdLettersForDelete").on("click", function () {
                $(".CheckForDelete").each(function () {
                    if ($(this).prop("checked") === true) {
                        var idLetterForDelete = $(this).attr("name");
                        arrayIdOfLetters.push(idLetterForDelete);
                    }
                });
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("DeleteAllSelected", "Message", routeValues: new { numberOfType = ViewBag.NumberOfType })",
                    data: JSON.stringify(arrayIdOfLetters),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        if (result == "OK") {
                            location.reload();
                        }
                        else
                            alert(result);
                    },
                    error: function (result) {
                        alert('Error!');
                    }
                });

                $("#CheckUncheckAllCheckbox").change(function () {
                    var checkUnchek = $(this).prop("checked");
                    $(".CheckForDelete").prop("checked", checkUnchek);
                });
            });

        });
    </script>
}
